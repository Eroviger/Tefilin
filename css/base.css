:root {
  --accent:#ff5c8a;
  --accent2:#ff94b8;
  --bg:linear-gradient(135deg,#ffe2ec,#fff7f0);
  --card:#ffffff;
  --shadow:0 12px 28px -14px rgba(0,0,0,.25);
  --radius:20px;
  --text:#444;
  --grad-text:linear-gradient(90deg,var(--accent),var(--accent2));
  --transition:.6s cubic-bezier(.77,0,.18,1);
  font-family: 'Segoe UI', system-ui, Arial, sans-serif;
}
* { box-sizing: border-box; }
body {
  margin:0;
  background:var(--bg);
  color:var(--text);
  min-height:100vh;
  padding:1.2rem 1rem 3.5rem;
  display:flex;
  flex-direction:column;
  align-items:center;
}
.gradient-title {
  font-size:2.4rem;
  margin:0 0 1rem;
  background:var(--grad-text);
  -webkit-background-clip:text;
  color:transparent;
}
.hidden { display:none !important; }
.intro, .page-intro {
  max-width:640px;
  text-align:center;
  line-height:1.45;
  font-size:.95rem;
  margin:.2rem auto 1.6rem;
}
.grid {
  display:grid;
  gap:1.2rem;
  grid-template-columns:repeat(auto-fit,minmax(180px,1fr));
  max-width:760px;
  width:100%;
}
.card {
  background:var(--card);
  padding:1.1rem .9rem 1.3rem;
  border-radius:var(--radius);
  text-decoration:none;
  color:inherit;
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:.55rem;
  position:relative;
  box-shadow:var(--shadow);
  transition:var(--transition);
}
.card:hover { transform:translateY(-6px) rotate(-1deg); }
.card.locked {
  filter:grayscale(.8) brightness(.9);
  cursor:not-allowed;
  position:relative;
}
.card.locked::after{
  content:"游";
  position:absolute;
  top:8px; right:10px;
  font-size:1.1rem;
}
.emoji { font-size:2rem; }
.title { font-weight:600; font-size:.95rem; letter-spacing:.5px; color:#ff2c6b; }
.desc { font-size:.7rem; text-align:center; line-height:1.2; opacity:.75; }
.status { font-size:.65rem; background:#ffe3ef; padding:.25rem .55rem; border-radius:14px; }
.hint-small { font-size:.7rem; opacity:.6; margin:1.2rem 0 0; text-align:center; }
.foot { margin-top:auto; font-size:.65rem; opacity:.6; text-align:center; }
.back {
  position:fixed;
  top:10px; left:10px;
  background:#fff;
  padding:.45rem .9rem;
  border-radius:20px;
  text-decoration:none;
  font-size:.75rem;
  color:#444;
  box-shadow:0 3px 8px -4px rgba(0,0,0,.25);
  z-index:10;
}
.page-title { font-size:2rem; margin:.2rem 0 1rem; background:var(--grad-text); -webkit-background-clip:text; color:transparent; text-align:center; }
.grid-messages {
  display:grid;
  gap:18px;
  grid-template-columns:repeat(auto-fit,minmax(140px,1fr));
  max-width:880px;
  width:100%;
  margin:0 auto 1.4rem;
}
.msg-box {
  position:relative;
  height:140px;
  border-radius:18px;
  background:linear-gradient(145deg,var(--accent),var(--accent2));
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:600;
  letter-spacing:.5px;
  color:#fff;
  cursor:pointer;
  box-shadow:0 10px 22px -12px rgba(0,0,0,.4);
  transition:var(--transition);
  overflow:hidden;
}
.msg-box:hover { transform:translateY(-5px); }
.msg-box.open { background:#fff; color:var(--text); }
.msg-box .short { font-size:1.7rem; transition:.4s; }
.msg-box.open .short { transform:scale(0); }
.msg-box .inner { opacity:0; transform:translateY(10px); padding:.7rem; font-size:.7rem; line-height:1.3; text-align:center; transition:.5s; }
.msg-box.open .inner { opacity:1; transform:translateY(0); }
.counter { text-align:center; font-size:.75rem; opacity:.7; }
.modal {
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.6);
  display:none;
  align-items:center;
  justify-content:center;
  padding:1rem;
  z-index:40;
}
.modal.open { display:flex; }
.modal-content {
  background:#fff;
  max-width:480px;
  width:100%;
  border-radius:22px;
  padding:1.2rem 1.4rem 1.55rem;
  box-shadow:0 20px 60px -25px rgba(0,0,0,.5);
  position:relative;
  animation:pop .55s ease;
}
@keyframes pop {
  from {opacity:0; transform:scale(.85) translateY(20px);}
  to {opacity:1; transform:scale(1) translateY(0);}
}
.modal-content img {
  width:100%;
  border-radius:14px;
  margin:.7rem 0 .3rem;
}
.close {
  position:absolute;
  top:10px; right:14px;
  background:none;
  border:none;
  font-size:1.6rem;
  line-height:1;
  cursor:pointer;
  color:#666;
}
.book {
  position:relative;
  width:520px;
  max-width:100%;
  height:360px;
  perspective:2000px;
  margin:0 auto 1rem;
}
.page {
  position:absolute;
  inset:0;
  background:#fff;
  border-radius:10px;
  box-shadow:0 12px 35px -15px rgba(0,0,0,.35);
  transform-origin:left;
  transition:1s cubic-bezier(.77,0,.18,1);
  backface-visibility:hidden;
  overflow:hidden;
  display:flex;
}
.page-content {
  padding:1rem 1.2rem;
  display:flex;
  flex-direction:column;
  width:100%;
}
.page-content img {
  width:100%;
  object-fit:cover;
  border-radius:8px;
  margin:0 0 .6rem;
  max-height:150px;
}
.page-content h2 {
  margin:.1rem 0 .4rem;
  font-size:1.15rem;
  color:var(--accent);
}
.page-content p {
  margin:.3rem 0;
  line-height:1.4;
  font-size:.85rem;
}
.nav {
  display:flex;
  gap:.6rem;
  justify-content:center;
  margin:.3rem 0 .4rem;
}
button {
  background:var(--accent);
  border:none;
  color:#fff;
  padding:.55rem 1.15rem;
  border-radius:30px;
  cursor:pointer;
  font-size:.78rem;
  letter-spacing:.5px;
  box-shadow:0 6px 16px -6px rgba(0,0,0,.4);
  transition:.35s;
}
button:disabled { opacity:.35; cursor:not-allowed; }
button:hover:not(:disabled) { transform:translateY(-3px); }
.indicator { font-size:.7rem; opacity:.7; text-align:center; }
.audio-bar {
  display:flex;
  gap:.5rem;
  align-items:center;
  margin:0 0 .8rem;
  font-size:.7rem;
  background:#fff;
  padding:.4rem .8rem;
  border-radius:30px;
  box-shadow:0 4px 15px -10px rgba(0,0,0,.25);
}
.final-wrap {
  max-width:760px;
  text-align:center;
  margin-top:2rem;
  position:relative;
}
.final-name {
  font-size:3.3rem;
  margin:0 0 .3rem;
  background:var(--grad-text);
  -webkit-background-clip:text;
  color:transparent;
  letter-spacing:2px;
  animation: glow 4s ease-in-out infinite;
}
@keyframes glow {
  0%,100% { filter:drop-shadow(0 0 4px rgba(255,92,138,.4)); }
  50% { filter:drop-shadow(0 0 12px rgba(255,92,138,.85)); }
}
.final-msg {
  margin:.2rem 0 1rem;
  font-size:1.6rem;
  color:#ff2c6b;
}
.final-text {
  font-size:.95rem;
  line-height:1.5;
  margin:.4rem auto 1.4rem;
  max-width:640px;
}
.replay-btn { background:#ff2c6b; }
#confetti-canvas {
  position:fixed;
  inset:0;
  pointer-events:none;
  z-index:5;
}
.gating {
  position:fixed;
  inset:0;
  background:var(--bg);
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:60;
  padding:1rem;
}
.gating-card {
  background:#fff;
  width:100%;
  max-width:520px;
  border-radius:28px;
  padding:1.6rem 1.6rem 1.8rem;
  box-shadow:0 25px 55px -25px rgba(0,0,0,.4);
  animation:pop .7s ease;
}
#gating-text {
  font-size:1rem;
  line-height:1.45;
  margin:0 0 1.1rem;
}
#gating-next { font-size:.78rem; }
@media (max-width:620px){
  .page-content img { max-height:170px; }
  .final-name { font-size:2.6rem; }
}
/* ...tu CSS existente... */

/* ESTILOS DEL PASTEL EN LA P츼GINA FINAL */
.cake {
  position: relative;
  width: 240px;
  height: 200px;
  margin: 1.2rem auto 0;
  filter: drop-shadow(0 12px 28px rgba(0,0,0,.25));
  transition: .5s;
}
.cake.hidden { display: none !important; }
.plate {
  position: absolute;
  bottom: 0;
  left: 50%; transform: translateX(-50%);
  width: 260px; height: 18px;
  background: #fff;
  border-radius: 12px;
  box-shadow: inset 0 2px 0 #e5e5e5, 0 4px 10px rgba(0,0,0,.15);
}
.layer {
  position: absolute;
  left: 50%; transform: translateX(-50%);
  width: 220px; height: 44px;
  background: #ffe3ef;
  border: 2px solid #ffc3d6;
  border-radius: 10px;
  box-shadow: 0 6px 10px -6px rgba(0,0,0,.25);
}
.layer-bottom { bottom: 18px; }
.layer-middle { bottom: 66px; }
.layer-top    { bottom: 114px; height: 38px; }

.layer::after {
  content:"";
  position:absolute; left:0; right:0; top:-10px; height:14px;
  background: repeating-linear-gradient(
    45deg,
    #ff8db3 0 10px,
    #ffd2e2 10px 20px
  );
  border-top-left-radius:10px; border-top-right-radius:10px;
}

.candle {
  position: absolute;
  left: 50%; transform: translateX(-50%);
  bottom: 162px;
  width: 12px; height: 48px;
  background: repeating-linear-gradient(
    90deg,
    #ffd95e 0 6px,
    #fff 6px 12px
  );
  border-radius: 6px;
  box-shadow: 0 2px 6px rgba(0,0,0,.2);
  display:flex; align-items:flex-start; justify-content:center;
}
.flame {
  width: 16px; height: 22px; margin-top:-18px;
  background: radial-gradient(ellipse at center, #fff59d 10%, #ffb74d 60%, #ff7043 100%);
  border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
  box-shadow: 0 0 12px 4px rgba(255,152,0,.65);
  animation: flicker 1.2s infinite ease-in-out;
}
@keyframes flicker {
  0%,100% { transform: translateY(0) scale(1); filter: brightness(1); }
  50%     { transform: translateY(-2px) scale(1.05); filter: brightness(1.15); }
}

.sprinkles {
  position:absolute; inset:0;
  background:
    radial-gradient(circle at 30% 65%, #ff5c8a 3px, transparent 4px),
    radial-gradient(circle at 60% 45%, #7dd3fc 3px, transparent 4px),
    radial-gradient(circle at 70% 78%, #a3e635 3px, transparent 4px),
    radial-gradient(circle at 40% 25%, #fca5a5 3px, transparent 4px),
    radial-gradient(circle at 80% 58%, #facc15 3px, transparent 4px);
  opacity:.6;
  pointer-events:none;
}

/* Bot칩n reutilizado */
.replay-btn { background:#ff2c6b; }
/* === Overrides 치lbum: mostrar imagen completa y texto debajo === */
.book {
  /* Altura m치s generosa y responsiva para que quepa la foto completa */
  height: clamp(420px, 70vh, 640px);
}

.page-content {
  display: flex;
  flex-direction: column;
  height: 100%;
}

/* Marco flexible para la imagen */
.img-box {
  flex: 1 1 auto;
  min-height: 240px;            /* asegura un 치rea visible decente */
  display: flex;
  align-items: center;
  justify-content: center;
  margin-bottom: .6rem;
}

/* Imagen sin recorte: se ajusta al marco */
.img-box img {
  max-width: 100%;
  max-height: 100%;
  width: auto;
  height: auto;
  object-fit: contain;
  border-radius: 8px;
}

/* Anula cualquier altura previa que recorte */
.page-content img { max-height: none !important; }

/* Espaciado de t칤tulo y texto bajo la imagen */
.page-content h2 { margin: .1rem 0 .35rem; }
.page-content p  { margin: .15rem 0; font-size: .9rem; line-height: 1.4; }
/* === Overrides 치lbum: imagen completa visible + texto debajo === */

/* Subimos el alto del libro para que quepan imagen + texto */
.book {
  height: clamp(520px, 82vh, 820px);
}

/* Estructura vertical de la p치gina */
.page-content {
  display: flex;
  flex-direction: column;
  height: 100%;
  overflow: auto;             /* permite hacer scroll si aun as칤 sobra contenido */
  scrollbar-width: thin;
}

/* Marco de imagen que NO ocupa todo el alto: deja espacio al texto */
.img-box {
  flex: 0 0 auto;
  max-height: 65%;            /* la imagen no pasar치 de 65% de la p치gina */
  min-height: 220px;          /* asegura una vista decente de imagen */
  display: flex;
  align-items: center;
  justify-content: center;
  margin-bottom: .6rem;
}

/* Imagen sin recorte */
.img-box img {
  max-width: 100%;
  max-height: 100%;
  width: auto;
  height: auto;
  object-fit: contain;
  border-radius: 8px;
}

/* Asegurar que no haya restricciones anteriores */
.page-content img { max-height: none !important; }

.page-content h2 { margin: .1rem 0 .35rem; font-size: 1.1rem; }
.page-content p  { margin: .15rem 0; font-size: .95rem; line-height: 1.45; overflow-wrap: anywhere; }